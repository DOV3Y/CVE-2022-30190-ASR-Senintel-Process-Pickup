//Summary of the action type against the process and ASR hit count to compared with other KQL
DeviceEvents
| where TimeGenerated > ago(30d)
| where ActionType startswith "Asr"
| where InitiatingProcessCommandLine contains "WINWORD.EXE"  or InitiatingProcessCommandLine contains "MSDT.exe" or InitiatingProcessCommandLine contains "sdiagnhost.exe" or InitiatingProcessCommandLine contains "conhost.exe"
| project
    TimeGenerated,
    ActionType,
    DeviceName,
    FileName,
    InitiatingProcessAccountDomain,
    InitiatingProcessAccountName,
    InitiatingProcessCommandLine,
    InitiatingProcessParentFileName,
    ProcessTokenElevation
| summarize ['ASR Hit Count']=count()by ActionType, InitiatingProcessCommandLine
| sort by ['ASR Hit Count'] desc 
